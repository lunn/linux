# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
%YAML 1.2
---
$id: http://devicetree.org/schemas/gpio/marvell,orion-gpio.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Marvel Orion GPIO controller

maintainers:
  - Andrew Lunn <andrew@lunn.ch>

properties:
  compatible:
    description:
      marvell,orion-gpio should be used for Orion, Kirkwood, Dove,
      Discovery (except MV78200) and Armada 370. marvell,mv78200-gpio
      should be used for the Discovery MV78200.

      marvel,armadaxp-gpio should be used for all Armada XP SoCs
      (MV78230, MV78260, MV78460).

      marvell,armada-8k-gpio should be used for the Armada 7K and 8K
      SoCs (either from AP or CP), see
      Documentation/devicetree/bindings/arm/marvell/ap80x-system-controller.txt
      for specific details about the offset property.
    enum:
      - marvell,orion-gpio
      - marvell,mv78200-gpio
      - marvell,armadaxp-gpio
      - marvell,armada-8k-gpio

  reg:
    description:
      Address and length of the register set for the device. Only one
      entry is expected, except for the marvell,armadaxp-gpio
      variant for which two entries are expected, one for the general
      registers, one for the per-cpu registers. Not used for
      marvell,armada-8k-gpio.

  interrupts:
    description:
      The list of interrupts that are used for all the pins
      managed by this GPIO bank. There can be more than one interrupt
      for example 1 interrupt per 8 pins on Armada XP, which means 4
      interrupts per bank of 32 GPIOs.

  interrupt-controller: true

  "#interrupt-cells":
    description:
      Should be 2. The first cell is the GPIO number. The second cell is
      used to specify flags

        bits[3:0] trigger type and level flags
          1 = low-to-high edge triggered.
          2 = high-to-low edge triggered.
          4 = active high level-sensitive.
          8 = active low level-sensitive.

      Valid combinations are 1, 2, 3, 4, 8.
    const: 2

  gpio-controller: true

  ngpios:
    description:
      Number of available gpios in a bank.
    minimum: 1
    maximum: 32

  '#gpio-cells':
    description:
      The first cell is the pin number. The second cell is reserved for
      flags, unused at the moment.
    const: 2

  clocks:
    maxItems: 1

patternProperties:
  "^.*$":
    if:
      type: object
    then:
      properties:
        gpio-hog: true
        gpios: true
        output-high: true
        output-low: true
        line-name: true

      required:
        - gpio-hog
        - gpios

      additionalProperties: false

required:
  - compatible
  - reg
  - interrupts
  - interrupt-controller
  - '#interrupt-cells'
  - gpio-controller
  - ngpios
  - '#gpio-cells'

allOf:
  - if:
      properties:
        compatible:
          contains:
            const: marvell,armadaxp-gpio
    then:
      properties:
        reg:
          minItems: 2
          maxItems: 2
        reg-names:
          items:
            - const: gpio
            - const: pwm
    else:
      properties:
        reg:
          minItems: 1
          maxItems: 1

additionalProperties: false

examples:
  - |
    gpio0: gpio@d0018100 {
        compatible = "marvell,armadaxp-gpio";
        reg = <0xd0018100 0x40>,
              <0xd0018800 0x30>;
        ngpios = <32>;
        gpio-controller;
        #gpio-cells = <2>;
        interrupt-controller;
        #interrupt-cells = <2>;
        interrupts = <16>, <17>, <18>, <19>;
    };

    gpio1: gpio@18140 {
        compatible = "marvell,armada-370-gpio";
        reg = <0x18140 0x40>, <0x181c8 0x08>;
        reg-names = "gpio", "pwm";
        ngpios = <17>;
        gpio-controller;
        #gpio-cells = <2>;
        #pwm-cells = <2>;
        interrupt-controller;
        #interrupt-cells = <2>;
        interrupts = <87>, <88>, <89>;
        clocks = <&coreclk 0>;
    };
