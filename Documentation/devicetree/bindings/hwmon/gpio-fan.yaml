# SPDX-License-Identifier: (GPL-2.0 OR BSD-2-Clause)
%YAML 1.2
---

$id: http://devicetree.org/schemas/hwmon/gpio-fan.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Fan connected to GPIO lines

maintainers:
  - Andrew Lunn <andrew@lunn.ch>

properties:
  compatible:
    const: gpio-fan

  gpios:
    description:
      Specifies the pins that map to bits in the control value,
      ordered MSB-->LSB.

  gpio-fan,speed-map:
    $ref: '/schemas/types.yaml#/definitions/uint32-array'
    description:
      A mapping of possible fan RPM speeds and the control value that should
      be set to achieve them. This array must have the RPM values in
      ascending order.

  alarm-gpios:
    description:
      This pin going active indicates something is wrong with the fan, and a
      udev event will be fired.

  '#cooling-cells':
    description: If used as a cooling device
    const: 2

anyOf:
  - required:
      - gpios
  - required:
      - alarm-gpios

required:
  - compatible

additionalProperties: false

examples:
  - |
    gpio_fan {
        compatible = "gpio-fan";
        gpios = <&gpio1 14 1
                 &gpio1 13 1>;
        gpio-fan,speed-map = <0    0
                              3000 1
                              6000 2>;
        alarm-gpios = <&gpio1 15 1>;
    };

    gpio_fan_cool: gpio_fan_cool {
        compatible = "gpio-fan";
        gpios = <&gpio2 14 1
                 &gpio2 13 1>;
        gpio-fan,speed-map =    <0    0>,
                                <3000 1>,
                                <6000 2>;
        alarm-gpios = <&gpio2 15 1>;
        #cooling-cells = <2>; /* min followed by max */
    };

    gpio_fan_alarm: gpio_fan_alarm {
        compatible = "gpio-fan";
        alarm-gpios = <&gpio2 15 1>;
    };
...
